<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ecedehey Creator</title>
    <script type="module" crossorigin>
(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))y(h);new MutationObserver(h=>{for(const l of h)if(l.type==="childList")for(const a of l.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&y(a)}).observe(document,{childList:!0,subtree:!0});function p(h){const l={};return h.integrity&&(l.integrity=h.integrity),h.referrerPolicy&&(l.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?l.credentials="include":h.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function y(h){if(h.ep)return;h.ep=!0;const l=p(h);fetch(h.href,l)}})();const Lt=(f,c)=>{(!("crypto"in window)||!("subtle"in crypto))&&(f.classList.add("error"),f.innerText="This browser does not support Esedehay (missing subtle webcrypto)",c.remove())};var H={},D={};D.byteLength=Ot;D.toByteArray=Pt;D.fromByteArray=Dt;var S=[],F=[],vt=typeof Uint8Array<"u"?Uint8Array:Array,G="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var O=0,Ct=G.length;O<Ct;++O)S[O]=G[O],F[G.charCodeAt(O)]=O;F["-".charCodeAt(0)]=62;F["_".charCodeAt(0)]=63;function ct(f){var c=f.length;if(c%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var p=f.indexOf("=");p===-1&&(p=c);var y=p===c?0:4-p%4;return[p,y]}function Ot(f){var c=ct(f),p=c[0],y=c[1];return(p+y)*3/4-y}function Nt(f,c,p){return(c+p)*3/4-p}function Pt(f){var c,p=ct(f),y=p[0],h=p[1],l=new vt(Nt(f,y,h)),a=0,o=h>0?y-4:y,w;for(w=0;w<o;w+=4)c=F[f.charCodeAt(w)]<<18|F[f.charCodeAt(w+1)]<<12|F[f.charCodeAt(w+2)]<<6|F[f.charCodeAt(w+3)],l[a++]=c>>16&255,l[a++]=c>>8&255,l[a++]=c&255;return h===2&&(c=F[f.charCodeAt(w)]<<2|F[f.charCodeAt(w+1)]>>4,l[a++]=c&255),h===1&&(c=F[f.charCodeAt(w)]<<10|F[f.charCodeAt(w+1)]<<4|F[f.charCodeAt(w+2)]>>2,l[a++]=c>>8&255,l[a++]=c&255),l}function Mt(f){return S[f>>18&63]+S[f>>12&63]+S[f>>6&63]+S[f&63]}function $t(f,c,p){for(var y,h=[],l=c;l<p;l+=3)y=(f[l]<<16&16711680)+(f[l+1]<<8&65280)+(f[l+2]&255),h.push(Mt(y));return h.join("")}function Dt(f){for(var c,p=f.length,y=p%3,h=[],l=16383,a=0,o=p-y;a<o;a+=l)h.push($t(f,a,a+l>o?o:a+l));return y===1?(c=f[p-1],h.push(S[c>>2]+S[c<<4&63]+"==")):y===2&&(c=(f[p-2]<<8)+f[p-1],h.push(S[c>>10]+S[c>>4&63]+S[c<<2&63]+"=")),h.join("")}var J={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */J.read=function(f,c,p,y,h){var l,a,o=h*8-y-1,w=(1<<o)-1,T=w>>1,x=-7,I=p?h-1:0,_=p?-1:1,A=f[c+I];for(I+=_,l=A&(1<<-x)-1,A>>=-x,x+=o;x>0;l=l*256+f[c+I],I+=_,x-=8);for(a=l&(1<<-x)-1,l>>=-x,x+=y;x>0;a=a*256+f[c+I],I+=_,x-=8);if(l===0)l=1-T;else{if(l===w)return a?NaN:(A?-1:1)*(1/0);a=a+Math.pow(2,y),l=l-T}return(A?-1:1)*a*Math.pow(2,l-y)};J.write=function(f,c,p,y,h,l){var a,o,w,T=l*8-h-1,x=(1<<T)-1,I=x>>1,_=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,A=y?0:l-1,N=y?1:-1,P=c<0||c===0&&1/c<0?1:0;for(c=Math.abs(c),isNaN(c)||c===1/0?(o=isNaN(c)?1:0,a=x):(a=Math.floor(Math.log(c)/Math.LN2),c*(w=Math.pow(2,-a))<1&&(a--,w*=2),a+I>=1?c+=_/w:c+=_*Math.pow(2,1-I),c*w>=2&&(a++,w/=2),a+I>=x?(o=0,a=x):a+I>=1?(o=(c*w-1)*Math.pow(2,h),a=a+I):(o=c*Math.pow(2,I-1)*Math.pow(2,h),a=0));h>=8;f[p+A]=o&255,A+=N,o/=256,h-=8);for(a=a<<h|o,T+=h;T>0;f[p+A]=a&255,A+=N,a/=256,T-=8);f[p+A-N]|=P*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(f){const c=D,p=J,y=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;f.Buffer=o,f.SlowBuffer=lt,f.INSPECT_MAX_BYTES=50;const h=2147483647;f.kMaxLength=h,o.TYPED_ARRAY_SUPPORT=l(),!o.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function l(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),e.foo()===42}catch{return!1}}Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}});function a(e){if(e>h)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,o.prototype),t}function o(e,t,r){if(typeof e=="number"){if(typeof t=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return I(e)}return w(e,t,r)}o.poolSize=8192;function w(e,t,r){if(typeof e=="string")return _(e,t);if(ArrayBuffer.isView(e))return N(e);if(e==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(k(e,ArrayBuffer)||e&&k(e.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(k(e,SharedArrayBuffer)||e&&k(e.buffer,SharedArrayBuffer)))return P(e,t,r);if(typeof e=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(n!=null&&n!==e)return o.from(n,t,r);const i=ht(e);if(i)return i;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof e[Symbol.toPrimitive]=="function")return o.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}o.from=function(e,t,r){return w(e,t,r)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array);function T(e){if(typeof e!="number")throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function x(e,t,r){return T(e),e<=0?a(e):t!==void 0?typeof r=="string"?a(e).fill(t,r):a(e).fill(t):a(e)}o.alloc=function(e,t,r){return x(e,t,r)};function I(e){return T(e),a(e<0?0:j(e)|0)}o.allocUnsafe=function(e){return I(e)},o.allocUnsafeSlow=function(e){return I(e)};function _(e,t){if((typeof t!="string"||t==="")&&(t="utf8"),!o.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=V(e,t)|0;let n=a(r);const i=n.write(e,t);return i!==r&&(n=n.slice(0,i)),n}function A(e){const t=e.length<0?0:j(e.length)|0,r=a(t);for(let n=0;n<t;n+=1)r[n]=e[n]&255;return r}function N(e){if(k(e,Uint8Array)){const t=new Uint8Array(e);return P(t.buffer,t.byteOffset,t.byteLength)}return A(e)}function P(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return t===void 0&&r===void 0?n=new Uint8Array(e):r===void 0?n=new Uint8Array(e,t):n=new Uint8Array(e,t,r),Object.setPrototypeOf(n,o.prototype),n}function ht(e){if(o.isBuffer(e)){const t=j(e.length)|0,r=a(t);return r.length===0||e.copy(r,0,0,t),r}if(e.length!==void 0)return typeof e.length!="number"||Y(e.length)?a(0):A(e);if(e.type==="Buffer"&&Array.isArray(e.data))return A(e.data)}function j(e){if(e>=h)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+h.toString(16)+" bytes");return e|0}function lt(e){return+e!=e&&(e=0),o.alloc(+e)}o.isBuffer=function(t){return t!=null&&t._isBuffer===!0&&t!==o.prototype},o.compare=function(t,r){if(k(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),k(r,Uint8Array)&&(r=o.from(r,r.offset,r.byteLength)),!o.isBuffer(t)||!o.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===r)return 0;let n=t.length,i=r.length;for(let u=0,s=Math.min(n,i);u<s;++u)if(t[u]!==r[u]){n=t[u],i=r[u];break}return n<i?-1:i<n?1:0},o.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(t,r){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(t.length===0)return o.alloc(0);let n;if(r===void 0)for(r=0,n=0;n<t.length;++n)r+=t[n].length;const i=o.allocUnsafe(r);let u=0;for(n=0;n<t.length;++n){let s=t[n];if(k(s,Uint8Array))u+s.length>i.length?(o.isBuffer(s)||(s=o.from(s)),s.copy(i,u)):Uint8Array.prototype.set.call(i,s,u);else if(o.isBuffer(s))s.copy(i,u);else throw new TypeError('"list" argument must be an Array of Buffers');u+=s.length}return i};function V(e,t){if(o.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||k(e,ArrayBuffer))return e.byteLength;if(typeof e!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,n=arguments.length>2&&arguments[2]===!0;if(!n&&r===0)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return K(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return ut(e).length;default:if(i)return n?-1:K(e).length;t=(""+t).toLowerCase(),i=!0}}o.byteLength=V;function pt(e,t,r){let n=!1;if((t===void 0||t<0)&&(t=0),t>this.length||((r===void 0||r>this.length)&&(r=this.length),r<=0)||(r>>>=0,t>>>=0,r<=t))return"";for(e||(e="utf8");;)switch(e){case"hex":return It(this,t,r);case"utf8":case"utf-8":return X(this,t,r);case"ascii":return Bt(this,t,r);case"latin1":case"binary":return xt(this,t,r);case"base64":return Et(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return At(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}o.prototype._isBuffer=!0;function L(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}o.prototype.swap16=function(){const t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let r=0;r<t;r+=2)L(this,r,r+1);return this},o.prototype.swap32=function(){const t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let r=0;r<t;r+=4)L(this,r,r+3),L(this,r+1,r+2);return this},o.prototype.swap64=function(){const t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let r=0;r<t;r+=8)L(this,r,r+7),L(this,r+1,r+6),L(this,r+2,r+5),L(this,r+3,r+4);return this},o.prototype.toString=function(){const t=this.length;return t===0?"":arguments.length===0?X(this,0,t):pt.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(t){if(!o.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?!0:o.compare(this,t)===0},o.prototype.inspect=function(){let t="";const r=f.INSPECT_MAX_BYTES;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},y&&(o.prototype[y]=o.prototype.inspect),o.prototype.compare=function(t,r,n,i,u){if(k(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(r===void 0&&(r=0),n===void 0&&(n=t?t.length:0),i===void 0&&(i=0),u===void 0&&(u=this.length),r<0||n>t.length||i<0||u>this.length)throw new RangeError("out of range index");if(i>=u&&r>=n)return 0;if(i>=u)return-1;if(r>=n)return 1;if(r>>>=0,n>>>=0,i>>>=0,u>>>=0,this===t)return 0;let s=u-i,d=n-r;const E=Math.min(s,d),m=this.slice(i,u),b=t.slice(r,n);for(let g=0;g<E;++g)if(m[g]!==b[g]){s=m[g],d=b[g];break}return s<d?-1:d<s?1:0};function z(e,t,r,n,i){if(e.length===0)return-1;if(typeof r=="string"?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,Y(r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0)if(i)r=0;else return-1;if(typeof t=="string"&&(t=o.from(t,n)),o.isBuffer(t))return t.length===0?-1:W(e,t,r,n,i);if(typeof t=="number")return t=t&255,typeof Uint8Array.prototype.indexOf=="function"?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):W(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function W(e,t,r,n,i){let u=1,s=e.length,d=t.length;if(n!==void 0&&(n=String(n).toLowerCase(),n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le")){if(e.length<2||t.length<2)return-1;u=2,s/=2,d/=2,r/=2}function E(b,g){return u===1?b[g]:b.readUInt16BE(g*u)}let m;if(i){let b=-1;for(m=r;m<s;m++)if(E(e,m)===E(t,b===-1?0:m-b)){if(b===-1&&(b=m),m-b+1===d)return b*u}else b!==-1&&(m-=m-b),b=-1}else for(r+d>s&&(r=s-d),m=r;m>=0;m--){let b=!0;for(let g=0;g<d;g++)if(E(e,m+g)!==E(t,g)){b=!1;break}if(b)return m}return-1}o.prototype.includes=function(t,r,n){return this.indexOf(t,r,n)!==-1},o.prototype.indexOf=function(t,r,n){return z(this,t,r,n,!0)},o.prototype.lastIndexOf=function(t,r,n){return z(this,t,r,n,!1)};function yt(e,t,r,n){r=Number(r)||0;const i=e.length-r;n?(n=Number(n),n>i&&(n=i)):n=i;const u=t.length;n>u/2&&(n=u/2);let s;for(s=0;s<n;++s){const d=parseInt(t.substr(s*2,2),16);if(Y(d))return s;e[r+s]=d}return s}function dt(e,t,r,n){return $(K(t,e.length-r),e,r,n)}function gt(e,t,r,n){return $(kt(t),e,r,n)}function wt(e,t,r,n){return $(ut(t),e,r,n)}function mt(e,t,r,n){return $(St(t,e.length-r),e,r,n)}o.prototype.write=function(t,r,n,i){if(r===void 0)i="utf8",n=this.length,r=0;else if(n===void 0&&typeof r=="string")i=r,n=this.length,r=0;else if(isFinite(r))r=r>>>0,isFinite(n)?(n=n>>>0,i===void 0&&(i="utf8")):(i=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const u=this.length-r;if((n===void 0||n>u)&&(n=u),t.length>0&&(n<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let s=!1;for(;;)switch(i){case"hex":return yt(this,t,r,n);case"utf8":case"utf-8":return dt(this,t,r,n);case"ascii":case"latin1":case"binary":return gt(this,t,r,n);case"base64":return wt(this,t,r,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return mt(this,t,r,n);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Et(e,t,r){return t===0&&r===e.length?c.fromByteArray(e):c.fromByteArray(e.slice(t,r))}function X(e,t,r){r=Math.min(e.length,r);const n=[];let i=t;for(;i<r;){const u=e[i];let s=null,d=u>239?4:u>223?3:u>191?2:1;if(i+d<=r){let E,m,b,g;switch(d){case 1:u<128&&(s=u);break;case 2:E=e[i+1],(E&192)===128&&(g=(u&31)<<6|E&63,g>127&&(s=g));break;case 3:E=e[i+1],m=e[i+2],(E&192)===128&&(m&192)===128&&(g=(u&15)<<12|(E&63)<<6|m&63,g>2047&&(g<55296||g>57343)&&(s=g));break;case 4:E=e[i+1],m=e[i+2],b=e[i+3],(E&192)===128&&(m&192)===128&&(b&192)===128&&(g=(u&15)<<18|(E&63)<<12|(m&63)<<6|b&63,g>65535&&g<1114112&&(s=g))}}s===null?(s=65533,d=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|s&1023),n.push(s),i+=d}return bt(n)}const Z=4096;function bt(e){const t=e.length;if(t<=Z)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=Z));return r}function Bt(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(e[i]&127);return n}function xt(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function It(e,t,r){const n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let i="";for(let u=t;u<r;++u)i+=_t[e[u]];return i}function At(e,t,r){const n=e.slice(t,r);let i="";for(let u=0;u<n.length-1;u+=2)i+=String.fromCharCode(n[u]+n[u+1]*256);return i}o.prototype.slice=function(t,r){const n=this.length;t=~~t,r=r===void 0?n:~~r,t<0?(t+=n,t<0&&(t=0)):t>n&&(t=n),r<0?(r+=n,r<0&&(r=0)):r>n&&(r=n),r<t&&(r=t);const i=this.subarray(t,r);return Object.setPrototypeOf(i,o.prototype),i};function B(e,t,r){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}o.prototype.readUintLE=o.prototype.readUIntLE=function(t,r,n){t=t>>>0,r=r>>>0,n||B(t,r,this.length);let i=this[t],u=1,s=0;for(;++s<r&&(u*=256);)i+=this[t+s]*u;return i},o.prototype.readUintBE=o.prototype.readUIntBE=function(t,r,n){t=t>>>0,r=r>>>0,n||B(t,r,this.length);let i=this[t+--r],u=1;for(;r>0&&(u*=256);)i+=this[t+--r]*u;return i},o.prototype.readUint8=o.prototype.readUInt8=function(t,r){return t=t>>>0,r||B(t,1,this.length),this[t]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(t,r){return t=t>>>0,r||B(t,2,this.length),this[t]|this[t+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(t,r){return t=t>>>0,r||B(t,2,this.length),this[t]<<8|this[t+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(t,r){return t=t>>>0,r||B(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+this[t+3]*16777216},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(t,r){return t=t>>>0,r||B(t,4,this.length),this[t]*16777216+(this[t+1]<<16|this[t+2]<<8|this[t+3])},o.prototype.readBigUInt64LE=R(function(t){t=t>>>0,C(t,"offset");const r=this[t],n=this[t+7];(r===void 0||n===void 0)&&M(t,this.length-8);const i=r+this[++t]*2**8+this[++t]*2**16+this[++t]*2**24,u=this[++t]+this[++t]*2**8+this[++t]*2**16+n*2**24;return BigInt(i)+(BigInt(u)<<BigInt(32))}),o.prototype.readBigUInt64BE=R(function(t){t=t>>>0,C(t,"offset");const r=this[t],n=this[t+7];(r===void 0||n===void 0)&&M(t,this.length-8);const i=r*2**24+this[++t]*2**16+this[++t]*2**8+this[++t],u=this[++t]*2**24+this[++t]*2**16+this[++t]*2**8+n;return(BigInt(i)<<BigInt(32))+BigInt(u)}),o.prototype.readIntLE=function(t,r,n){t=t>>>0,r=r>>>0,n||B(t,r,this.length);let i=this[t],u=1,s=0;for(;++s<r&&(u*=256);)i+=this[t+s]*u;return u*=128,i>=u&&(i-=Math.pow(2,8*r)),i},o.prototype.readIntBE=function(t,r,n){t=t>>>0,r=r>>>0,n||B(t,r,this.length);let i=r,u=1,s=this[t+--i];for(;i>0&&(u*=256);)s+=this[t+--i]*u;return u*=128,s>=u&&(s-=Math.pow(2,8*r)),s},o.prototype.readInt8=function(t,r){return t=t>>>0,r||B(t,1,this.length),this[t]&128?(255-this[t]+1)*-1:this[t]},o.prototype.readInt16LE=function(t,r){t=t>>>0,r||B(t,2,this.length);const n=this[t]|this[t+1]<<8;return n&32768?n|4294901760:n},o.prototype.readInt16BE=function(t,r){t=t>>>0,r||B(t,2,this.length);const n=this[t+1]|this[t]<<8;return n&32768?n|4294901760:n},o.prototype.readInt32LE=function(t,r){return t=t>>>0,r||B(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},o.prototype.readInt32BE=function(t,r){return t=t>>>0,r||B(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},o.prototype.readBigInt64LE=R(function(t){t=t>>>0,C(t,"offset");const r=this[t],n=this[t+7];(r===void 0||n===void 0)&&M(t,this.length-8);const i=this[t+4]+this[t+5]*2**8+this[t+6]*2**16+(n<<24);return(BigInt(i)<<BigInt(32))+BigInt(r+this[++t]*2**8+this[++t]*2**16+this[++t]*2**24)}),o.prototype.readBigInt64BE=R(function(t){t=t>>>0,C(t,"offset");const r=this[t],n=this[t+7];(r===void 0||n===void 0)&&M(t,this.length-8);const i=(r<<24)+this[++t]*2**16+this[++t]*2**8+this[++t];return(BigInt(i)<<BigInt(32))+BigInt(this[++t]*2**24+this[++t]*2**16+this[++t]*2**8+n)}),o.prototype.readFloatLE=function(t,r){return t=t>>>0,r||B(t,4,this.length),p.read(this,t,!0,23,4)},o.prototype.readFloatBE=function(t,r){return t=t>>>0,r||B(t,4,this.length),p.read(this,t,!1,23,4)},o.prototype.readDoubleLE=function(t,r){return t=t>>>0,r||B(t,8,this.length),p.read(this,t,!0,52,8)},o.prototype.readDoubleBE=function(t,r){return t=t>>>0,r||B(t,8,this.length),p.read(this,t,!1,52,8)};function U(e,t,r,n,i,u){if(!o.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<u)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}o.prototype.writeUintLE=o.prototype.writeUIntLE=function(t,r,n,i){if(t=+t,r=r>>>0,n=n>>>0,!i){const d=Math.pow(2,8*n)-1;U(this,t,r,n,d,0)}let u=1,s=0;for(this[r]=t&255;++s<n&&(u*=256);)this[r+s]=t/u&255;return r+n},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(t,r,n,i){if(t=+t,r=r>>>0,n=n>>>0,!i){const d=Math.pow(2,8*n)-1;U(this,t,r,n,d,0)}let u=n-1,s=1;for(this[r+u]=t&255;--u>=0&&(s*=256);)this[r+u]=t/s&255;return r+n},o.prototype.writeUint8=o.prototype.writeUInt8=function(t,r,n){return t=+t,r=r>>>0,n||U(this,t,r,1,255,0),this[r]=t&255,r+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(t,r,n){return t=+t,r=r>>>0,n||U(this,t,r,2,65535,0),this[r]=t&255,this[r+1]=t>>>8,r+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(t,r,n){return t=+t,r=r>>>0,n||U(this,t,r,2,65535,0),this[r]=t>>>8,this[r+1]=t&255,r+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(t,r,n){return t=+t,r=r>>>0,n||U(this,t,r,4,4294967295,0),this[r+3]=t>>>24,this[r+2]=t>>>16,this[r+1]=t>>>8,this[r]=t&255,r+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(t,r,n){return t=+t,r=r>>>0,n||U(this,t,r,4,4294967295,0),this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=t&255,r+4};function Q(e,t,r,n,i){ot(t,n,i,e,r,7);let u=Number(t&BigInt(4294967295));e[r++]=u,u=u>>8,e[r++]=u,u=u>>8,e[r++]=u,u=u>>8,e[r++]=u;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=s,s=s>>8,e[r++]=s,s=s>>8,e[r++]=s,s=s>>8,e[r++]=s,r}function tt(e,t,r,n,i){ot(t,n,i,e,r,7);let u=Number(t&BigInt(4294967295));e[r+7]=u,u=u>>8,e[r+6]=u,u=u>>8,e[r+5]=u,u=u>>8,e[r+4]=u;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=s,s=s>>8,e[r+2]=s,s=s>>8,e[r+1]=s,s=s>>8,e[r]=s,r+8}o.prototype.writeBigUInt64LE=R(function(t,r=0){return Q(this,t,r,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeBigUInt64BE=R(function(t,r=0){return tt(this,t,r,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeIntLE=function(t,r,n,i){if(t=+t,r=r>>>0,!i){const E=Math.pow(2,8*n-1);U(this,t,r,n,E-1,-E)}let u=0,s=1,d=0;for(this[r]=t&255;++u<n&&(s*=256);)t<0&&d===0&&this[r+u-1]!==0&&(d=1),this[r+u]=(t/s>>0)-d&255;return r+n},o.prototype.writeIntBE=function(t,r,n,i){if(t=+t,r=r>>>0,!i){const E=Math.pow(2,8*n-1);U(this,t,r,n,E-1,-E)}let u=n-1,s=1,d=0;for(this[r+u]=t&255;--u>=0&&(s*=256);)t<0&&d===0&&this[r+u+1]!==0&&(d=1),this[r+u]=(t/s>>0)-d&255;return r+n},o.prototype.writeInt8=function(t,r,n){return t=+t,r=r>>>0,n||U(this,t,r,1,127,-128),t<0&&(t=255+t+1),this[r]=t&255,r+1},o.prototype.writeInt16LE=function(t,r,n){return t=+t,r=r>>>0,n||U(this,t,r,2,32767,-32768),this[r]=t&255,this[r+1]=t>>>8,r+2},o.prototype.writeInt16BE=function(t,r,n){return t=+t,r=r>>>0,n||U(this,t,r,2,32767,-32768),this[r]=t>>>8,this[r+1]=t&255,r+2},o.prototype.writeInt32LE=function(t,r,n){return t=+t,r=r>>>0,n||U(this,t,r,4,2147483647,-2147483648),this[r]=t&255,this[r+1]=t>>>8,this[r+2]=t>>>16,this[r+3]=t>>>24,r+4},o.prototype.writeInt32BE=function(t,r,n){return t=+t,r=r>>>0,n||U(this,t,r,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=t&255,r+4},o.prototype.writeBigInt64LE=R(function(t,r=0){return Q(this,t,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),o.prototype.writeBigInt64BE=R(function(t,r=0){return tt(this,t,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function rt(e,t,r,n,i,u){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function et(e,t,r,n,i){return t=+t,r=r>>>0,i||rt(e,t,r,4),p.write(e,t,r,n,23,4),r+4}o.prototype.writeFloatLE=function(t,r,n){return et(this,t,r,!0,n)},o.prototype.writeFloatBE=function(t,r,n){return et(this,t,r,!1,n)};function nt(e,t,r,n,i){return t=+t,r=r>>>0,i||rt(e,t,r,8),p.write(e,t,r,n,52,8),r+8}o.prototype.writeDoubleLE=function(t,r,n){return nt(this,t,r,!0,n)},o.prototype.writeDoubleBE=function(t,r,n){return nt(this,t,r,!1,n)},o.prototype.copy=function(t,r,n,i){if(!o.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),!i&&i!==0&&(i=this.length),r>=t.length&&(r=t.length),r||(r=0),i>0&&i<n&&(i=n),i===n||t.length===0||this.length===0)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-r<i-n&&(i=t.length-r+n);const u=i-n;return this===t&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(r,n,i):Uint8Array.prototype.set.call(t,this.subarray(n,i),r),u},o.prototype.fill=function(t,r,n,i){if(typeof t=="string"){if(typeof r=="string"?(i=r,r=0,n=this.length):typeof n=="string"&&(i=n,n=this.length),i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!o.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(t.length===1){const s=t.charCodeAt(0);(i==="utf8"&&s<128||i==="latin1")&&(t=s)}}else typeof t=="number"?t=t&255:typeof t=="boolean"&&(t=Number(t));if(r<0||this.length<r||this.length<n)throw new RangeError("Out of range index");if(n<=r)return this;r=r>>>0,n=n===void 0?this.length:n>>>0,t||(t=0);let u;if(typeof t=="number")for(u=r;u<n;++u)this[u]=t;else{const s=o.isBuffer(t)?t:o.from(t,i),d=s.length;if(d===0)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(u=0;u<n-r;++u)this[u+r]=s[u%d]}return this};const v={};function q(e,t,r){v[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(i){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:i,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}q("ERR_BUFFER_OUT_OF_BOUNDS",function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),q("ERR_INVALID_ARG_TYPE",function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`},TypeError),q("ERR_OUT_OF_RANGE",function(e,t,r){let n=`The value of "${e}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=it(String(r)):typeof r=="bigint"&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=it(i)),i+="n"),n+=` It must be ${t}. Received ${i}`,n},RangeError);function it(e){let t="",r=e.length;const n=e[0]==="-"?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function Ut(e,t,r){C(t,"offset"),(e[t]===void 0||e[t+r]===void 0)&&M(t,e.length-(r+1))}function ot(e,t,r,n,i,u){if(e>r||e<t){const s=typeof t=="bigint"?"n":"";let d;throw u>3?t===0||t===BigInt(0)?d=`>= 0${s} and < 2${s} ** ${(u+1)*8}${s}`:d=`>= -(2${s} ** ${(u+1)*8-1}${s}) and < 2 ** ${(u+1)*8-1}${s}`:d=`>= ${t}${s} and <= ${r}${s}`,new v.ERR_OUT_OF_RANGE("value",d,e)}Ut(n,i,u)}function C(e,t){if(typeof e!="number")throw new v.ERR_INVALID_ARG_TYPE(t,"number",e)}function M(e,t,r){throw Math.floor(e)!==e?(C(e,r),new v.ERR_OUT_OF_RANGE(r||"offset","an integer",e)):t<0?new v.ERR_BUFFER_OUT_OF_BOUNDS:new v.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${t}`,e)}const Ft=/[^+/0-9A-Za-z-_]/g;function Tt(e){if(e=e.split("=")[0],e=e.trim().replace(Ft,""),e.length<2)return"";for(;e.length%4!==0;)e=e+"=";return e}function K(e,t){t=t||1/0;let r;const n=e.length;let i=null;const u=[];for(let s=0;s<n;++s){if(r=e.charCodeAt(s),r>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&u.push(239,191,189);continue}else if(s+1===n){(t-=3)>-1&&u.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&u.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(t-=3)>-1&&u.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;u.push(r)}else if(r<2048){if((t-=2)<0)break;u.push(r>>6|192,r&63|128)}else if(r<65536){if((t-=3)<0)break;u.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((t-=4)<0)break;u.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return u}function kt(e){const t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r)&255);return t}function St(e,t){let r,n,i;const u=[];for(let s=0;s<e.length&&!((t-=2)<0);++s)r=e.charCodeAt(s),n=r>>8,i=r%256,u.push(i),u.push(n);return u}function ut(e){return c.toByteArray(Tt(e))}function $(e,t,r,n){let i;for(i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function k(e,t){return e instanceof t||e!=null&&e.constructor!=null&&e.constructor.name!=null&&e.constructor.name===t.name}function Y(e){return e!==e}const _t=function(){const e="0123456789abcdef",t=new Array(256);for(let r=0;r<16;++r){const n=r*16;for(let i=0;i<16;++i)t[n+i]=e[r]+e[i]}return t}();function R(e){return typeof BigInt>"u"?Rt:e}function Rt(){throw new Error("BigInt not supported")}})(H);const jt=f=>f.replace(/\//g,"_").replace(/\+/g,"-").replace(/=/g,""),st=f=>f.replace(/-/g,"+").replace(/_/g,"/"),ft=f=>new Uint8Array(new H.Buffer(f,"base64").buffer),qt=f=>Array.from(new Uint8Array(f)).slice(16).map(c=>c.toString(16).padStart(2,"0")).join(""),Kt=(f,c,p)=>{const y=document.createElement("a");y.href=URL.createObjectURL(new Blob([f],{type:p})),y.download=c,document.body.append(y),y.click(),y.remove()},Yt=async()=>await crypto.subtle.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey"]),at=async f=>crypto.subtle.exportKey("jwk",f),Gt=async f=>{const c=await at(f),p=ft(st(c.x)),y=ft(st(c.y)),h=new Uint8Array(65);h.set(new Uint8Array([4]),0),h.set(p,1),h.set(y,32);const l=await crypto.subtle.digest("SHA-256",h);return"0k"+qt(l)},Ht=f=>jt(new H.Buffer(JSON.stringify(f)).toString("base64")),Jt=`<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ecedehey private key:</title>
    <script type="module" crossorigin>
(function(){const f=document.createElement("link").relList;if(f&&f.supports&&f.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))y(a);new MutationObserver(a=>{for(const h of a)if(h.type==="childList")for(const l of h.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&y(l)}).observe(document,{childList:!0,subtree:!0});function p(a){const h={};return a.integrity&&(h.integrity=a.integrity),a.referrerPolicy&&(h.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?h.credentials="include":a.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function y(a){if(a.ep)return;a.ep=!0;const h=p(a);fetch(a.href,h)}})();var L={},H={};H.byteLength=Ht;H.toByteArray=Vt;H.fromByteArray=Xt;var C=[],T=[],jt=typeof Uint8Array<"u"?Uint8Array:Array,Z="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var M=0,Gt=Z.length;M<Gt;++M)C[M]=Z[M],T[Z.charCodeAt(M)]=M;T["-".charCodeAt(0)]=62;T["_".charCodeAt(0)]=63;function wt(s){var f=s.length;if(f%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var p=s.indexOf("=");p===-1&&(p=f);var y=p===f?0:4-p%4;return[p,y]}function Ht(s){var f=wt(s),p=f[0],y=f[1];return(p+y)*3/4-y}function Yt(s,f,p){return(f+p)*3/4-p}function Vt(s){var f,p=wt(s),y=p[0],a=p[1],h=new jt(Yt(s,y,a)),l=0,o=a>0?y-4:y,d;for(d=0;d<o;d+=4)f=T[s.charCodeAt(d)]<<18|T[s.charCodeAt(d+1)]<<12|T[s.charCodeAt(d+2)]<<6|T[s.charCodeAt(d+3)],h[l++]=f>>16&255,h[l++]=f>>8&255,h[l++]=f&255;return a===2&&(f=T[s.charCodeAt(d)]<<2|T[s.charCodeAt(d+1)]>>4,h[l++]=f&255),a===1&&(f=T[s.charCodeAt(d)]<<10|T[s.charCodeAt(d+1)]<<4|T[s.charCodeAt(d+2)]>>2,h[l++]=f>>8&255,h[l++]=f&255),h}function Wt(s){return C[s>>18&63]+C[s>>12&63]+C[s>>6&63]+C[s&63]}function zt(s,f,p){for(var y,a=[],h=f;h<p;h+=3)y=(s[h]<<16&16711680)+(s[h+1]<<8&65280)+(s[h+2]&255),a.push(Wt(y));return a.join("")}function Xt(s){for(var f,p=s.length,y=p%3,a=[],h=16383,l=0,o=p-y;l<o;l+=h)a.push(zt(s,l,l+h>o?o:l+h));return y===1?(f=s[p-1],a.push(C[f>>2]+C[f<<4&63]+"==")):y===2&&(f=(s[p-2]<<8)+s[p-1],a.push(C[f>>10]+C[f>>4&63]+C[f<<2&63]+"=")),a.join("")}var Q={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */Q.read=function(s,f,p,y,a){var h,l,o=a*8-y-1,d=(1<<o)-1,A=d>>1,g=-7,I=p?a-1:0,S=p?-1:1,U=s[f+I];for(I+=S,h=U&(1<<-g)-1,U>>=-g,g+=o;g>0;h=h*256+s[f+I],I+=S,g-=8);for(l=h&(1<<-g)-1,h>>=-g,g+=y;g>0;l=l*256+s[f+I],I+=S,g-=8);if(h===0)h=1-A;else{if(h===d)return l?NaN:(U?-1:1)*(1/0);l=l+Math.pow(2,y),h=h-A}return(U?-1:1)*l*Math.pow(2,h-y)};Q.write=function(s,f,p,y,a,h){var l,o,d,A=h*8-a-1,g=(1<<A)-1,I=g>>1,S=a===23?Math.pow(2,-24)-Math.pow(2,-77):0,U=y?0:h-1,O=y?1:-1,$=f<0||f===0&&1/f<0?1:0;for(f=Math.abs(f),isNaN(f)||f===1/0?(o=isNaN(f)?1:0,l=g):(l=Math.floor(Math.log(f)/Math.LN2),f*(d=Math.pow(2,-l))<1&&(l--,d*=2),l+I>=1?f+=S/d:f+=S*Math.pow(2,1-I),f*d>=2&&(l++,d/=2),l+I>=g?(o=0,l=g):l+I>=1?(o=(f*d-1)*Math.pow(2,a),l=l+I):(o=f*Math.pow(2,I-1)*Math.pow(2,a),l=0));a>=8;s[p+U]=o&255,U+=O,o/=256,a-=8);for(l=l<<a|o,A+=a;A>0;s[p+U]=l&255,U+=O,l/=256,A-=8);s[p+U-O]|=$*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(s){const f=H,p=Q,y=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;s.Buffer=o,s.SlowBuffer=Ft,s.INSPECT_MAX_BYTES=50;const a=2147483647;s.kMaxLength=a,o.TYPED_ARRAY_SUPPORT=h(),!o.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by \`buffer\` v5.x. Use \`buffer\` v4.x if you require old browser support.");function h(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),e.foo()===42}catch{return!1}}Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}});function l(e){if(e>a)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,o.prototype),t}function o(e,t,r){if(typeof e=="number"){if(typeof t=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return I(e)}return d(e,t,r)}o.poolSize=8192;function d(e,t,r){if(typeof e=="string")return S(e,t);if(ArrayBuffer.isView(e))return O(e);if(e==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(R(e,ArrayBuffer)||e&&R(e.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(R(e,SharedArrayBuffer)||e&&R(e.buffer,SharedArrayBuffer)))return $(e,t,r);if(typeof e=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(n!=null&&n!==e)return o.from(n,t,r);const i=It(e);if(i)return i;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof e[Symbol.toPrimitive]=="function")return o.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}o.from=function(e,t,r){return d(e,t,r)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array);function A(e){if(typeof e!="number")throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function g(e,t,r){return A(e),e<=0?l(e):t!==void 0?typeof r=="string"?l(e).fill(t,r):l(e).fill(t):l(e)}o.alloc=function(e,t,r){return g(e,t,r)};function I(e){return A(e),l(e<0?0:V(e)|0)}o.allocUnsafe=function(e){return I(e)},o.allocUnsafeSlow=function(e){return I(e)};function S(e,t){if((typeof t!="string"||t==="")&&(t="utf8"),!o.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=rt(e,t)|0;let n=l(r);const i=n.write(e,t);return i!==r&&(n=n.slice(0,i)),n}function U(e){const t=e.length<0?0:V(e.length)|0,r=l(t);for(let n=0;n<t;n+=1)r[n]=e[n]&255;return r}function O(e){if(R(e,Uint8Array)){const t=new Uint8Array(e);return $(t.buffer,t.byteOffset,t.byteLength)}return U(e)}function $(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return t===void 0&&r===void 0?n=new Uint8Array(e):r===void 0?n=new Uint8Array(e,t):n=new Uint8Array(e,t,r),Object.setPrototypeOf(n,o.prototype),n}function It(e){if(o.isBuffer(e)){const t=V(e.length)|0,r=l(t);return r.length===0||e.copy(r,0,0,t),r}if(e.length!==void 0)return typeof e.length!="number"||X(e.length)?l(0):U(e);if(e.type==="Buffer"&&Array.isArray(e.data))return U(e.data)}function V(e){if(e>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return e|0}function Ft(e){return+e!=e&&(e=0),o.alloc(+e)}o.isBuffer=function(t){return t!=null&&t._isBuffer===!0&&t!==o.prototype},o.compare=function(t,r){if(R(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),R(r,Uint8Array)&&(r=o.from(r,r.offset,r.byteLength)),!o.isBuffer(t)||!o.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===r)return 0;let n=t.length,i=r.length;for(let u=0,c=Math.min(n,i);u<c;++u)if(t[u]!==r[u]){n=t[u],i=r[u];break}return n<i?-1:i<n?1:0},o.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(t,r){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(t.length===0)return o.alloc(0);let n;if(r===void 0)for(r=0,n=0;n<t.length;++n)r+=t[n].length;const i=o.allocUnsafe(r);let u=0;for(n=0;n<t.length;++n){let c=t[n];if(R(c,Uint8Array))u+c.length>i.length?(o.isBuffer(c)||(c=o.from(c)),c.copy(i,u)):Uint8Array.prototype.set.call(i,c,u);else if(o.isBuffer(c))c.copy(i,u);else throw new TypeError('"list" argument must be an Array of Buffers');u+=c.length}return i};function rt(e,t){if(o.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||R(e,ArrayBuffer))return e.byteLength;if(typeof e!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,n=arguments.length>2&&arguments[2]===!0;if(!n&&r===0)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return z(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return pt(e).length;default:if(i)return n?-1:z(e).length;t=(""+t).toLowerCase(),i=!0}}o.byteLength=rt;function At(e,t,r){let n=!1;if((t===void 0||t<0)&&(t=0),t>this.length||((r===void 0||r>this.length)&&(r=this.length),r<=0)||(r>>>=0,t>>>=0,r<=t))return"";for(e||(e="utf8");;)switch(e){case"hex":return Pt(this,t,r);case"utf8":case"utf-8":return it(this,t,r);case"ascii":return kt(this,t,r);case"latin1":case"binary":return _t(this,t,r);case"base64":return Ct(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Nt(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}o.prototype._isBuffer=!0;function _(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}o.prototype.swap16=function(){const t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let r=0;r<t;r+=2)_(this,r,r+1);return this},o.prototype.swap32=function(){const t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let r=0;r<t;r+=4)_(this,r,r+3),_(this,r+1,r+2);return this},o.prototype.swap64=function(){const t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let r=0;r<t;r+=8)_(this,r,r+7),_(this,r+1,r+6),_(this,r+2,r+5),_(this,r+3,r+4);return this},o.prototype.toString=function(){const t=this.length;return t===0?"":arguments.length===0?it(this,0,t):At.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(t){if(!o.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?!0:o.compare(this,t)===0},o.prototype.inspect=function(){let t="";const r=s.INSPECT_MAX_BYTES;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},y&&(o.prototype[y]=o.prototype.inspect),o.prototype.compare=function(t,r,n,i,u){if(R(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(r===void 0&&(r=0),n===void 0&&(n=t?t.length:0),i===void 0&&(i=0),u===void 0&&(u=this.length),r<0||n>t.length||i<0||u>this.length)throw new RangeError("out of range index");if(i>=u&&r>=n)return 0;if(i>=u)return-1;if(r>=n)return 1;if(r>>>=0,n>>>=0,i>>>=0,u>>>=0,this===t)return 0;let c=u-i,w=n-r;const E=Math.min(c,w),B=this.slice(i,u),m=t.slice(r,n);for(let x=0;x<E;++x)if(B[x]!==m[x]){c=B[x],w=m[x];break}return c<w?-1:w<c?1:0};function et(e,t,r,n,i){if(e.length===0)return-1;if(typeof r=="string"?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,X(r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0)if(i)r=0;else return-1;if(typeof t=="string"&&(t=o.from(t,n)),o.isBuffer(t))return t.length===0?-1:nt(e,t,r,n,i);if(typeof t=="number")return t=t&255,typeof Uint8Array.prototype.indexOf=="function"?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):nt(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function nt(e,t,r,n,i){let u=1,c=e.length,w=t.length;if(n!==void 0&&(n=String(n).toLowerCase(),n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le")){if(e.length<2||t.length<2)return-1;u=2,c/=2,w/=2,r/=2}function E(m,x){return u===1?m[x]:m.readUInt16BE(x*u)}let B;if(i){let m=-1;for(B=r;B<c;B++)if(E(e,B)===E(t,m===-1?0:B-m)){if(m===-1&&(m=B),B-m+1===w)return m*u}else m!==-1&&(B-=B-m),m=-1}else for(r+w>c&&(r=c-w),B=r;B>=0;B--){let m=!0;for(let x=0;x<w;x++)if(E(e,B+x)!==E(t,x)){m=!1;break}if(m)return B}return-1}o.prototype.includes=function(t,r,n){return this.indexOf(t,r,n)!==-1},o.prototype.indexOf=function(t,r,n){return et(this,t,r,n,!0)},o.prototype.lastIndexOf=function(t,r,n){return et(this,t,r,n,!1)};function Ut(e,t,r,n){r=Number(r)||0;const i=e.length-r;n?(n=Number(n),n>i&&(n=i)):n=i;const u=t.length;n>u/2&&(n=u/2);let c;for(c=0;c<n;++c){const w=parseInt(t.substr(c*2,2),16);if(X(w))return c;e[r+c]=w}return c}function bt(e,t,r,n){return J(z(t,e.length-r),e,r,n)}function Tt(e,t,r,n){return J($t(t),e,r,n)}function St(e,t,r,n){return J(pt(t),e,r,n)}function Rt(e,t,r,n){return J(Kt(t,e.length-r),e,r,n)}o.prototype.write=function(t,r,n,i){if(r===void 0)i="utf8",n=this.length,r=0;else if(n===void 0&&typeof r=="string")i=r,n=this.length,r=0;else if(isFinite(r))r=r>>>0,isFinite(n)?(n=n>>>0,i===void 0&&(i="utf8")):(i=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const u=this.length-r;if((n===void 0||n>u)&&(n=u),t.length>0&&(n<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let c=!1;for(;;)switch(i){case"hex":return Ut(this,t,r,n);case"utf8":case"utf-8":return bt(this,t,r,n);case"ascii":case"latin1":case"binary":return Tt(this,t,r,n);case"base64":return St(this,t,r,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Rt(this,t,r,n);default:if(c)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),c=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Ct(e,t,r){return t===0&&r===e.length?f.fromByteArray(e):f.fromByteArray(e.slice(t,r))}function it(e,t,r){r=Math.min(e.length,r);const n=[];let i=t;for(;i<r;){const u=e[i];let c=null,w=u>239?4:u>223?3:u>191?2:1;if(i+w<=r){let E,B,m,x;switch(w){case 1:u<128&&(c=u);break;case 2:E=e[i+1],(E&192)===128&&(x=(u&31)<<6|E&63,x>127&&(c=x));break;case 3:E=e[i+1],B=e[i+2],(E&192)===128&&(B&192)===128&&(x=(u&15)<<12|(E&63)<<6|B&63,x>2047&&(x<55296||x>57343)&&(c=x));break;case 4:E=e[i+1],B=e[i+2],m=e[i+3],(E&192)===128&&(B&192)===128&&(m&192)===128&&(x=(u&15)<<18|(E&63)<<12|(B&63)<<6|m&63,x>65535&&x<1114112&&(c=x))}}c===null?(c=65533,w=1):c>65535&&(c-=65536,n.push(c>>>10&1023|55296),c=56320|c&1023),n.push(c),i+=w}return Lt(n)}const ot=4096;function Lt(e){const t=e.length;if(t<=ot)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=ot));return r}function kt(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(e[i]&127);return n}function _t(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function Pt(e,t,r){const n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let i="";for(let u=t;u<r;++u)i+=qt[e[u]];return i}function Nt(e,t,r){const n=e.slice(t,r);let i="";for(let u=0;u<n.length-1;u+=2)i+=String.fromCharCode(n[u]+n[u+1]*256);return i}o.prototype.slice=function(t,r){const n=this.length;t=~~t,r=r===void 0?n:~~r,t<0?(t+=n,t<0&&(t=0)):t>n&&(t=n),r<0?(r+=n,r<0&&(r=0)):r>n&&(r=n),r<t&&(r=t);const i=this.subarray(t,r);return Object.setPrototypeOf(i,o.prototype),i};function F(e,t,r){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}o.prototype.readUintLE=o.prototype.readUIntLE=function(t,r,n){t=t>>>0,r=r>>>0,n||F(t,r,this.length);let i=this[t],u=1,c=0;for(;++c<r&&(u*=256);)i+=this[t+c]*u;return i},o.prototype.readUintBE=o.prototype.readUIntBE=function(t,r,n){t=t>>>0,r=r>>>0,n||F(t,r,this.length);let i=this[t+--r],u=1;for(;r>0&&(u*=256);)i+=this[t+--r]*u;return i},o.prototype.readUint8=o.prototype.readUInt8=function(t,r){return t=t>>>0,r||F(t,1,this.length),this[t]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(t,r){return t=t>>>0,r||F(t,2,this.length),this[t]|this[t+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(t,r){return t=t>>>0,r||F(t,2,this.length),this[t]<<8|this[t+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(t,r){return t=t>>>0,r||F(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+this[t+3]*16777216},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(t,r){return t=t>>>0,r||F(t,4,this.length),this[t]*16777216+(this[t+1]<<16|this[t+2]<<8|this[t+3])},o.prototype.readBigUInt64LE=k(function(t){t=t>>>0,N(t,"offset");const r=this[t],n=this[t+7];(r===void 0||n===void 0)&&K(t,this.length-8);const i=r+this[++t]*2**8+this[++t]*2**16+this[++t]*2**24,u=this[++t]+this[++t]*2**8+this[++t]*2**16+n*2**24;return BigInt(i)+(BigInt(u)<<BigInt(32))}),o.prototype.readBigUInt64BE=k(function(t){t=t>>>0,N(t,"offset");const r=this[t],n=this[t+7];(r===void 0||n===void 0)&&K(t,this.length-8);const i=r*2**24+this[++t]*2**16+this[++t]*2**8+this[++t],u=this[++t]*2**24+this[++t]*2**16+this[++t]*2**8+n;return(BigInt(i)<<BigInt(32))+BigInt(u)}),o.prototype.readIntLE=function(t,r,n){t=t>>>0,r=r>>>0,n||F(t,r,this.length);let i=this[t],u=1,c=0;for(;++c<r&&(u*=256);)i+=this[t+c]*u;return u*=128,i>=u&&(i-=Math.pow(2,8*r)),i},o.prototype.readIntBE=function(t,r,n){t=t>>>0,r=r>>>0,n||F(t,r,this.length);let i=r,u=1,c=this[t+--i];for(;i>0&&(u*=256);)c+=this[t+--i]*u;return u*=128,c>=u&&(c-=Math.pow(2,8*r)),c},o.prototype.readInt8=function(t,r){return t=t>>>0,r||F(t,1,this.length),this[t]&128?(255-this[t]+1)*-1:this[t]},o.prototype.readInt16LE=function(t,r){t=t>>>0,r||F(t,2,this.length);const n=this[t]|this[t+1]<<8;return n&32768?n|4294901760:n},o.prototype.readInt16BE=function(t,r){t=t>>>0,r||F(t,2,this.length);const n=this[t+1]|this[t]<<8;return n&32768?n|4294901760:n},o.prototype.readInt32LE=function(t,r){return t=t>>>0,r||F(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},o.prototype.readInt32BE=function(t,r){return t=t>>>0,r||F(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},o.prototype.readBigInt64LE=k(function(t){t=t>>>0,N(t,"offset");const r=this[t],n=this[t+7];(r===void 0||n===void 0)&&K(t,this.length-8);const i=this[t+4]+this[t+5]*2**8+this[t+6]*2**16+(n<<24);return(BigInt(i)<<BigInt(32))+BigInt(r+this[++t]*2**8+this[++t]*2**16+this[++t]*2**24)}),o.prototype.readBigInt64BE=k(function(t){t=t>>>0,N(t,"offset");const r=this[t],n=this[t+7];(r===void 0||n===void 0)&&K(t,this.length-8);const i=(r<<24)+this[++t]*2**16+this[++t]*2**8+this[++t];return(BigInt(i)<<BigInt(32))+BigInt(this[++t]*2**24+this[++t]*2**16+this[++t]*2**8+n)}),o.prototype.readFloatLE=function(t,r){return t=t>>>0,r||F(t,4,this.length),p.read(this,t,!0,23,4)},o.prototype.readFloatBE=function(t,r){return t=t>>>0,r||F(t,4,this.length),p.read(this,t,!1,23,4)},o.prototype.readDoubleLE=function(t,r){return t=t>>>0,r||F(t,8,this.length),p.read(this,t,!0,52,8)},o.prototype.readDoubleBE=function(t,r){return t=t>>>0,r||F(t,8,this.length),p.read(this,t,!1,52,8)};function b(e,t,r,n,i,u){if(!o.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<u)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}o.prototype.writeUintLE=o.prototype.writeUIntLE=function(t,r,n,i){if(t=+t,r=r>>>0,n=n>>>0,!i){const w=Math.pow(2,8*n)-1;b(this,t,r,n,w,0)}let u=1,c=0;for(this[r]=t&255;++c<n&&(u*=256);)this[r+c]=t/u&255;return r+n},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(t,r,n,i){if(t=+t,r=r>>>0,n=n>>>0,!i){const w=Math.pow(2,8*n)-1;b(this,t,r,n,w,0)}let u=n-1,c=1;for(this[r+u]=t&255;--u>=0&&(c*=256);)this[r+u]=t/c&255;return r+n},o.prototype.writeUint8=o.prototype.writeUInt8=function(t,r,n){return t=+t,r=r>>>0,n||b(this,t,r,1,255,0),this[r]=t&255,r+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(t,r,n){return t=+t,r=r>>>0,n||b(this,t,r,2,65535,0),this[r]=t&255,this[r+1]=t>>>8,r+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(t,r,n){return t=+t,r=r>>>0,n||b(this,t,r,2,65535,0),this[r]=t>>>8,this[r+1]=t&255,r+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(t,r,n){return t=+t,r=r>>>0,n||b(this,t,r,4,4294967295,0),this[r+3]=t>>>24,this[r+2]=t>>>16,this[r+1]=t>>>8,this[r]=t&255,r+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(t,r,n){return t=+t,r=r>>>0,n||b(this,t,r,4,4294967295,0),this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=t&255,r+4};function ut(e,t,r,n,i){lt(t,n,i,e,r,7);let u=Number(t&BigInt(4294967295));e[r++]=u,u=u>>8,e[r++]=u,u=u>>8,e[r++]=u,u=u>>8,e[r++]=u;let c=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=c,c=c>>8,e[r++]=c,c=c>>8,e[r++]=c,c=c>>8,e[r++]=c,r}function ct(e,t,r,n,i){lt(t,n,i,e,r,7);let u=Number(t&BigInt(4294967295));e[r+7]=u,u=u>>8,e[r+6]=u,u=u>>8,e[r+5]=u,u=u>>8,e[r+4]=u;let c=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=c,c=c>>8,e[r+2]=c,c=c>>8,e[r+1]=c,c=c>>8,e[r]=c,r+8}o.prototype.writeBigUInt64LE=k(function(t,r=0){return ut(this,t,r,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeBigUInt64BE=k(function(t,r=0){return ct(this,t,r,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeIntLE=function(t,r,n,i){if(t=+t,r=r>>>0,!i){const E=Math.pow(2,8*n-1);b(this,t,r,n,E-1,-E)}let u=0,c=1,w=0;for(this[r]=t&255;++u<n&&(c*=256);)t<0&&w===0&&this[r+u-1]!==0&&(w=1),this[r+u]=(t/c>>0)-w&255;return r+n},o.prototype.writeIntBE=function(t,r,n,i){if(t=+t,r=r>>>0,!i){const E=Math.pow(2,8*n-1);b(this,t,r,n,E-1,-E)}let u=n-1,c=1,w=0;for(this[r+u]=t&255;--u>=0&&(c*=256);)t<0&&w===0&&this[r+u+1]!==0&&(w=1),this[r+u]=(t/c>>0)-w&255;return r+n},o.prototype.writeInt8=function(t,r,n){return t=+t,r=r>>>0,n||b(this,t,r,1,127,-128),t<0&&(t=255+t+1),this[r]=t&255,r+1},o.prototype.writeInt16LE=function(t,r,n){return t=+t,r=r>>>0,n||b(this,t,r,2,32767,-32768),this[r]=t&255,this[r+1]=t>>>8,r+2},o.prototype.writeInt16BE=function(t,r,n){return t=+t,r=r>>>0,n||b(this,t,r,2,32767,-32768),this[r]=t>>>8,this[r+1]=t&255,r+2},o.prototype.writeInt32LE=function(t,r,n){return t=+t,r=r>>>0,n||b(this,t,r,4,2147483647,-2147483648),this[r]=t&255,this[r+1]=t>>>8,this[r+2]=t>>>16,this[r+3]=t>>>24,r+4},o.prototype.writeInt32BE=function(t,r,n){return t=+t,r=r>>>0,n||b(this,t,r,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=t&255,r+4},o.prototype.writeBigInt64LE=k(function(t,r=0){return ut(this,t,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),o.prototype.writeBigInt64BE=k(function(t,r=0){return ct(this,t,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function st(e,t,r,n,i,u){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function ft(e,t,r,n,i){return t=+t,r=r>>>0,i||st(e,t,r,4),p.write(e,t,r,n,23,4),r+4}o.prototype.writeFloatLE=function(t,r,n){return ft(this,t,r,!0,n)},o.prototype.writeFloatBE=function(t,r,n){return ft(this,t,r,!1,n)};function at(e,t,r,n,i){return t=+t,r=r>>>0,i||st(e,t,r,8),p.write(e,t,r,n,52,8),r+8}o.prototype.writeDoubleLE=function(t,r,n){return at(this,t,r,!0,n)},o.prototype.writeDoubleBE=function(t,r,n){return at(this,t,r,!1,n)},o.prototype.copy=function(t,r,n,i){if(!o.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),!i&&i!==0&&(i=this.length),r>=t.length&&(r=t.length),r||(r=0),i>0&&i<n&&(i=n),i===n||t.length===0||this.length===0)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-r<i-n&&(i=t.length-r+n);const u=i-n;return this===t&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(r,n,i):Uint8Array.prototype.set.call(t,this.subarray(n,i),r),u},o.prototype.fill=function(t,r,n,i){if(typeof t=="string"){if(typeof r=="string"?(i=r,r=0,n=this.length):typeof n=="string"&&(i=n,n=this.length),i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!o.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(t.length===1){const c=t.charCodeAt(0);(i==="utf8"&&c<128||i==="latin1")&&(t=c)}}else typeof t=="number"?t=t&255:typeof t=="boolean"&&(t=Number(t));if(r<0||this.length<r||this.length<n)throw new RangeError("Out of range index");if(n<=r)return this;r=r>>>0,n=n===void 0?this.length:n>>>0,t||(t=0);let u;if(typeof t=="number")for(u=r;u<n;++u)this[u]=t;else{const c=o.isBuffer(t)?t:o.from(t,i),w=c.length;if(w===0)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(u=0;u<n-r;++u)this[u+r]=c[u%w]}return this};const P={};function W(e,t,r){P[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=\`\${this.name} [\${e}]\`,this.stack,delete this.name}get code(){return e}set code(i){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:i,writable:!0})}toString(){return\`\${this.name} [\${e}]: \${this.message}\`}}}W("ERR_BUFFER_OUT_OF_BOUNDS",function(e){return e?\`\${e} is outside of buffer bounds\`:"Attempt to access memory outside buffer bounds"},RangeError),W("ERR_INVALID_ARG_TYPE",function(e,t){return\`The "\${e}" argument must be of type number. Received type \${typeof t}\`},TypeError),W("ERR_OUT_OF_RANGE",function(e,t,r){let n=\`The value of "\${e}" is out of range.\`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=ht(String(r)):typeof r=="bigint"&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=ht(i)),i+="n"),n+=\` It must be \${t}. Received \${i}\`,n},RangeError);function ht(e){let t="",r=e.length;const n=e[0]==="-"?1:0;for(;r>=n+4;r-=3)t=\`_\${e.slice(r-3,r)}\${t}\`;return\`\${e.slice(0,r)}\${t}\`}function Mt(e,t,r){N(t,"offset"),(e[t]===void 0||e[t+r]===void 0)&&K(t,e.length-(r+1))}function lt(e,t,r,n,i,u){if(e>r||e<t){const c=typeof t=="bigint"?"n":"";let w;throw u>3?t===0||t===BigInt(0)?w=\`>= 0\${c} and < 2\${c} ** \${(u+1)*8}\${c}\`:w=\`>= -(2\${c} ** \${(u+1)*8-1}\${c}) and < 2 ** \${(u+1)*8-1}\${c}\`:w=\`>= \${t}\${c} and <= \${r}\${c}\`,new P.ERR_OUT_OF_RANGE("value",w,e)}Mt(n,i,u)}function N(e,t){if(typeof e!="number")throw new P.ERR_INVALID_ARG_TYPE(t,"number",e)}function K(e,t,r){throw Math.floor(e)!==e?(N(e,r),new P.ERR_OUT_OF_RANGE(r||"offset","an integer",e)):t<0?new P.ERR_BUFFER_OUT_OF_BOUNDS:new P.ERR_OUT_OF_RANGE(r||"offset",\`>= \${r?1:0} and <= \${t}\`,e)}const Dt=/[^+/0-9A-Za-z-_]/g;function Ot(e){if(e=e.split("=")[0],e=e.trim().replace(Dt,""),e.length<2)return"";for(;e.length%4!==0;)e=e+"=";return e}function z(e,t){t=t||1/0;let r;const n=e.length;let i=null;const u=[];for(let c=0;c<n;++c){if(r=e.charCodeAt(c),r>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&u.push(239,191,189);continue}else if(c+1===n){(t-=3)>-1&&u.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&u.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(t-=3)>-1&&u.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;u.push(r)}else if(r<2048){if((t-=2)<0)break;u.push(r>>6|192,r&63|128)}else if(r<65536){if((t-=3)<0)break;u.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((t-=4)<0)break;u.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return u}function $t(e){const t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r)&255);return t}function Kt(e,t){let r,n,i;const u=[];for(let c=0;c<e.length&&!((t-=2)<0);++c)r=e.charCodeAt(c),n=r>>8,i=r%256,u.push(i),u.push(n);return u}function pt(e){return f.toByteArray(Ot(e))}function J(e,t,r,n){let i;for(i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function R(e,t){return e instanceof t||e!=null&&e.constructor!=null&&e.constructor.name!=null&&e.constructor.name===t.name}function X(e){return e!==e}const qt=function(){const e="0123456789abcdef",t=new Array(256);for(let r=0;r<16;++r){const n=r*16;for(let i=0;i<16;++i)t[n+i]=e[r]+e[i]}return t}();function k(e){return typeof BigInt>"u"?Jt:e}function Jt(){throw new Error("BigInt not supported")}})(L);const G=s=>s.replace(/\\//g,"_").replace(/\\+/g,"-").replace(/=/g,""),q=s=>s.replace(/-/g,"+").replace(/_/g,"/"),D=s=>s instanceof ArrayBuffer?G(L.Buffer.from(s).toString("base64")):G(new L.Buffer(s,"utf8").toString("base64")),yt=s=>new Uint8Array(new L.Buffer(s,"base64").buffer),dt=s=>Array.from(new Uint8Array(s)).slice(16).map(f=>f.toString(16).padStart(2,"0")).join(""),xt=(s,f,p)=>{const y=document.createElement("a");y.href=URL.createObjectURL(new Blob([s],{type:p})),y.download=f,document.body.append(y),y.click(),y.remove()},v=s=>new Promise((f,p)=>{const y=new FileReader;y.onloadend=a=>{const h=a.target.result;f(h)},y.onerror=a=>p(a),y.readAsArrayBuffer(s)}),tt=async s=>crypto.subtle.exportKey("jwk",s),Zt=({alg:s,kty:f,ext:p,crv:y,x:a,y:h,key_ops:l})=>({alg:s,kty:f,ext:p,crv:y,x:a,y:h,key_ops:l}),Y=(s,f=["deriveKey"])=>crypto.subtle.importKey("jwk",s,{name:"ECDH",namedCurve:"P-256"},!0,f),gt=async s=>{const f=await tt(s),p=yt(q(f.x)),y=yt(q(f.y)),a=new Uint8Array(65);a.set(new Uint8Array([4]),0),a.set(p,1),a.set(y,32);const h=await crypto.subtle.digest("SHA-256",a);return"0k"+dt(h)},Qt=s=>{const f={kty:s.kty,crv:s.crv,x:s.x,y:s.y,ext:!0,key_opts:s.key_ops};return G(new L.Buffer(JSON.stringify(f)).toString("base64"))},Bt=s=>JSON.parse(new L.Buffer(q(s),"base64").toString("utf8"));const Et=(s,f)=>crypto.subtle.deriveKey({name:"ECDH",public:f},s,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"]),j=128,vt=async(s,f,p)=>{const y=await Et(s,f),a=new Uint8Array(12);crypto.getRandomValues(a);const h=await crypto.subtle.encrypt({name:"AES-GCM",length:256,iv:a,tagLength:j},y,p),l=h.slice(0,h.byteLength-j/8),o=h.slice(h.byteLength-j/8);return{iv:a,cipherText:l,authTag:o}},tr=async(s,f,p,y,a)=>{const h=await Et(s,f),l=new Uint8Array(y.byteLength+a.byteLength);return l.set(new Uint8Array(y),0),l.set(new Uint8Array(a),y.byteLength),crypto.subtle.decrypt({name:"AES-GCM",length:256,iv:p,tagLength:j},h,l)},rr=s=>{const[f,p,y,a,h]=s.split(".").map(g=>q(g)).map(g=>new L.Buffer(g,"base64")),l=JSON.parse(f.toString("utf8")),o=y.buffer,d=a.buffer,A=h.buffer;return{headers:l,iv:o,cipherText:d,authTag:A}},er=async s=>{const f=new TextEncoder,p=await crypto.subtle.digest("SHA-256",f.encode(s));return"0m"+dt(p)},nr=async({originalFileName:s,jwe:f,privateKey:p})=>D(JSON.stringify({originalFileName:s,jwe:f,otherPublicKey:Qt(await tt(p))})),ir=s=>JSON.parse(new L.Buffer(q(s),"base64").toString("utf8")),or=async s=>{const f=document.querySelector("#public-key"),p=document.querySelector("#public-key-download");document.querySelector("#app-version").innerText=\` (\${window.__ECEDEHEY_VERSION__})\`;const y=Zt(await tt(s)),a=await gt(s);f.innerText=G(new L.Buffer(JSON.stringify(y)).toString("base64")),p.href="data:text/base64url;charset=utf-8,"+encodeURIComponent(JSON.stringify(y)),p.download=\`ecedehey-PUBLIC_KEY-\${a}.jwk\`;const h=document.querySelector("#public-key-fingerprint");h.innerText=a,document.title="Ecedehey private key: "+a,document.querySelector("#other-public-key-input").addEventListener("change",fr),document.querySelector("#other-public-key-input").addEventListener("change",o=>{o.target.files.length>0&&(document.querySelector("#encrypt-button").disabled=!1)}),document.querySelector("#encrypt-button").addEventListener("click",cr(s)),document.querySelector("#decrypt-file-input").addEventListener("change",sr(s))},ur=()=>{var s;return(s=document.querySelector("#other-public-key-input"))==null?void 0:s.dataset.rawPublicKey},cr=s=>async()=>{const f=ur(),p=document.querySelector("#file-to-encrypt").files[0],y=await v(p);if(!f){console.error("Missing other public key");return}if(!y){console.error("Missing plain text to encrypt");return}const{iv:a,cipherText:h,authTag:l}=await vt(s,await Y(JSON.parse(f),[]),new Uint8Array(y)),o=JSON.stringify({alg:"ECDH",enc:"A256-GCM"}),d="",A=[D(o),D(d),D(a),D(h),D(l)].join("."),g=new TextEncoder;xt(g.encode(await nr({originalFileName:p.name,originalFileType:p.type,jwe:A,privateKey:s})),\`ecedehey-MESSAGE-\${await er(A)}.ecdhmsg\`,"text/plain")},sr=s=>async f=>{const p=new TextDecoder,y=await v(f.target.files[0]),a=p.decode(y);if(!a){console.error("Missing message to decrypt");return}const{jwe:h,otherPublicKey:l,originalFileName:o,originalFileType:d}=ir(a),{iv:A,cipherText:g,authTag:I}=rr(h),S=await tr(s,await Y(Bt(l),[]),A,g,I);await xt(S,o,d)},fr=async s=>{try{const f=s.target,p=await v(f.files[0]),a=new TextDecoder().decode(p);if(!a)throw new Error("Missing public key contents");const h=document.querySelector("#other-public-key-fingerprint"),l=await Y(JSON.parse(a),[]);h.classList.remove("display-none"),h.querySelector(".key-box__key").innerText=await gt(l),f.dataset.rawPublicKey=a,document.querySelector("#file-to-encrypt").files.length>0&&(document.querySelector("#encrypt-button").disabled=!1)}catch(f){console.error("Failed to compute key fingerprint: ",f)}};let mt;mt="%PRIVATE_KEY%";(async()=>{const s=await Y(Bt(mt));or(s)})();

<\/script>
    <style>
:root{--color-foreground: #47c747;--color-foreground--light: #72d072;--color-foreground--lighter: #85cc85;--color-error: #ef6565;--color-background: #1a1a1a;--color-background--light: #2c2c2c;--color-border: #707070;--color-disabled: #a0a0a0}body,html{margin:0;padding:0;height:100%;font-family:monospace;background:var(--color-background);color:var(--color-foreground)}h1,h2,h3,h4,h5,h6{font-family:inherit}a{color:var(--color-foreground--light)}a:hover{color:var(--color-foreground--lighter)}.error{color:var(--color-error)}.button,button{display:inline-block;font:inherit;background:var(--color-foreground);border:0;color:#000;padding:1rem 2rem;text-decoration:none;cursor:pointer}.button:hover,button:hover{color:#000;background:var(--color-foreground--light)}.button:disabled,button:disabled{background-color:var(--color-disabled);cursor:auto}label>span{display:block;padding-bottom:.5rem;font-weight:700;cursor:pointer}.file-input{font:inherit;max-width:100%}.display-none{display:none!important}.pad{padding:1rem}.push-bottom{margin-bottom:1rem}.key{max-width:80rem;margin:auto}.key__encryption{display:flex;flex-direction:column;width:100%;align-items:flex-start}.key__public-key__boxes__box{padding-bottom:1rem}.key-box{display:block;padding:1rem;width:100%;max-width:30rem;border:1px solid var(--color-border);border-radius:.5rem;background:var(--color-background--light);color:#fff}.key-box__title{font-size:.75rem;padding-bottom:.5rem}.key-box__key{user-select:all;margin:0;word-break:break-all;white-space:pre-line}

</style>
  </head>
  <body>
    <div id="info"></div>
    <div class="key pad">
      <div class="key__public-key">
        <h1>Ecedehey private key<span id="app-version"></span></h1>
        <div class="key-box push-bottom">
          <div class="key-box__title">Key Fingerprint</div>
          <div class="key-box__key" id="public-key-fingerprint"></div>
        </div>
        <p>
          Ecedehey is completely browser-based and client side, no data is sent
          to the server. It solely relies on the
          <a
            href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Crypto_API"
            target="_blank"
            >WebCrypto API</a
          >. Read more about it in the
          <a
            href="https://www.palmenhq.dev/annotated/2023/06/fun-with-webcrypto/"
            >blog post</a
          >.
        </p>
        <p></p>
        <div class="error push-bottom">
          <strong>Warning!</strong> Please note that this is built for
          educational purposes and has not been reviewed by any security expert.
          Do <strong>not</strong> rely on it for sensitive files.
        </div>
      </div>
      <div>
        <hr />

        <h2>Encrypt for target</h2>
        <p>
          Use this private key HTML file together with a public key JWK to
          encrypt a file, which can only be decrypted with the target private
          key HTML file.
        </p>

        <div>
          <label class="key-box push-bottom">
            <span>Target public key (jwk)</span>
            <input
              type="file"
              id="other-public-key-input"
              accept=".jwk"
              class="file-input"
            />
          </label>
          <div
            class="key-box display-none push-bottom"
            id="other-public-key-fingerprint"
          >
            <div class="key-box__title">Target key fingerprint</div>
            <pre class="key-box__key"></pre>
          </div>
        </div>

        <div>
          <label class="key-box push-bottom">
            <span>File to encrypt</span>
            <input type="file" id="file-to-encrypt" class="file-input"
          /></label>
        </div>

        <div>
          <button id="encrypt-button" class="button push-bottom" disabled>
            Encrypt &amp; download
          </button>
        </div>
      </div>
      <hr />
      <div class="key__encryption">
        <h1>Target public key</h1>
        <p>
          Download this public key and import it in an Ecedehey private key HTML
          file to encrypt something that can be decrypted with this private key
          file.
        </p>
        <div class="key-box push-bottom">
          <div class="key-box__title">Public key</div>
          <pre id="public-key" class="key-box__key"></pre>
        </div>
        <a
          href="#"
          id="public-key-download"
          class="button full-width push-bottom"
          >Download target public key</a
        >
      </div>
      <div>
        <hr />
        <h2>Decrypt</h2>
        <p>Decrypt a file that was encrypted with this target public key.</p>
        <div>
          <label class="key-box push-bottom">
            <span>File to decrypt</span>
            <input
              type="file"
              id="decrypt-file-input"
              accept=".ecdhmsg"
              class="file-input"
            />
          </label>
        </div>
        <div>
          <button id="decrypt-button">Decrypt &amp; download</button>
        </div>
      </div>
    </div>
  </body>

  <script>
    window.__ECEDEHEY_VERSION__ = '%VERSION%'
  <\/script>

  
</html>
`;try{const f=document.querySelector("#create"),c=document.querySelector("#info");Lt(c,f),f.addEventListener("click",async()=>{const p=await Yt(),y=await at(p.privateKey),h=Ht(y),l=new TextEncoder,a=Jt.replace("%PRIVATE_KEY%",h).replace("%VERSION%",window.__ECEDEHEY_VERSION__);Kt(l.encode(a),`esedehey-PRIVATE_KEY-${await Gt(p.privateKey)}.html`,"text/plain")})}catch(f){console.error(f),alert("Error initializing file")}

</script>
    <style>
:root{--color-foreground: #47c747;--color-foreground--light: #72d072;--color-foreground--lighter: #85cc85;--color-error: #ef6565;--color-background: #1a1a1a;--color-background--light: #2c2c2c;--color-border: #707070;--color-disabled: #a0a0a0}body,html{margin:0;padding:0;height:100%;font-family:monospace;background:var(--color-background);color:var(--color-foreground)}h1,h2,h3,h4,h5,h6{font-family:inherit}a{color:var(--color-foreground--light)}a:hover{color:var(--color-foreground--lighter)}.error{color:var(--color-error)}.button,button{display:inline-block;font:inherit;background:var(--color-foreground);border:0;color:#000;padding:1rem 2rem;text-decoration:none;cursor:pointer}.button:hover,button:hover{color:#000;background:var(--color-foreground--light)}.button:disabled,button:disabled{background-color:var(--color-disabled);cursor:auto}label>span{display:block;padding-bottom:.5rem;font-weight:700;cursor:pointer}.file-input{font:inherit;max-width:100%}.display-none{display:none!important}.pad{padding:1rem}.push-bottom{margin-bottom:1rem}.create{display:flex;width:100%;height:100%;justify-content:center;align-items:center;flex-direction:column}.create__copy{max-width:40rem;text-align:center}

</style>
  </head>
  <body>
    <div class="create">
      <div id="info"></div>
      <div class="create__copy">
        <h1>Ecdehey private key generator</h1>
        <p>
          To encrypt and decrypt files you need at least two private keys.
          Private key files in Ecedehey are self-contained HTML files that does
          encryption and decryption for you.
        </p>
        <p>
          <em
            >Ecedehey is completely browser-based and client side, no data is
            sent to the server. It solely relies on the
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Crypto_API"
              target="_blank"
              >WebCrypto API</a
            >.</em
          >
          You can even save this HTML page to your computer and open it with
          your preferred browser, to do the creation of private keys offline.
          Read more about it in the
          <a
            href="https://www.palmenhq.dev/annotated/2023/06/fun-with-webcrypto/"
            >blog post</a
          >.
        </p>
        <p class="error">
          Please note that this is built for educational purposes and has not
          been reviewed by any security expert. Do
          <strong>not</strong> rely on it for sensitive files.
        </p>
      </div>
      <button id="create">Create Ecedehey Private Key</button>
    </div>
    <script>
      window.__ECEDEHEY_VERSION__ = '1.0.0' // TODO automatically generate this
    </script>
    
  </body>
</html>
